<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete Your Booth Profile - CSC Conference</title>
    <link rel="stylesheet" href="https://use.typekit.net/ilr6ctr.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'davis-sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #ffffff;
            min-height: 100vh;
            overflow-x: hidden;
            padding: 3vh 3vw;
        }

        /* Background image - right side only in landscape */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            right: 0;
            width: 20%;
            height: 100%;
            background: url('https://images.squarespace-cdn.com/content/v1/5cf7db4cc0827b0001c9ff81/b115546f-0ea2-4efc-8401-79d0991119ce/Background+art.png?format=2500w') no-repeat right center;
            background-size: cover;
            z-index: -1;
        }

        /* DESKTOP: Container */
        .wizard-container {
            display: flex;
            width: 100%;
            height: calc(100vh - 6vh);
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.66);
            border-radius: 20px;
            border: 3px solid #000000;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        /* Sidebar */
        .sidebar {
            width: 23vw;
            height: 100%;
            background: #e6e6e6;
            padding: 50px 40px;
            display: flex;
            flex-direction: column;
            box-shadow: 6px 0 16px rgba(0, 0, 0, 0.3);
            position: relative;
            z-index: 2;
        }

        .logo-section {
            margin-bottom: 6vw;
            width: 100%;
        }

        .logo-and-title {
            display: flex;
            align-items: flex-start;
            gap: 1vw;
            height: 5vw;
            margin-bottom: 2vw;
        }

        .logo {
            width: 5vw;
            height: 5vw;
            flex-shrink: 1;
        }

        .logo-text {
            flex: 1;
            height: 5vw;
            display: flex;
            flex-direction: column;
            justify-content: left;
        }

        .booth-section {
            width: 100%;
            margin-left: 4.9vw;
        }

        .conference-title {
            font-family: 'davis-sans', sans-serif;
            font-weight: 700;
            font-size: 1.6vw;
            color: #000000;
            line-height: 1.15;
            margin: 0;
        }

        .booth-number {
            font-family: 'davis-sans', sans-serif;
            font-weight: 700;
            font-size: 2.1vw;
            color: #000000;
            margin: 0;
            line-height: 1;
        }

        /* Step Navigation */
        .step-navigation {
            flex: 1;
        }

        .step-item {
            display: flex;
            align-items: center;
            margin-bottom: 2vw;
            padding: 0.8vw 0;
        }

        .step-number {
            width: 2vw;
            height: 2vw;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 1.2vw;
            flex-shrink: 0;
        }

        .step-number svg {
            width: 1.4vw;
            height: 1.4vw;
        }

        .step-title {
            font-weight: 500;
            font-size: 1.2vw;
            color: #333333;
            line-height: 1.2;
        }

        /* Active step styling */
        .step-item.active .step-number svg {
            fill: #0071bc !important;
        }

        .step-item.active .step-title {
            color: #0071bc;
            font-weight: 700;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            padding: 0px 60px 80px 5%;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            position: relative;
            min-height: 400px;
        }

        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
        }

        /* Welcome Screen */
        .welcome-section {
            width: 50%;
            max-width: none;
            margin-top: 140px;
        }

        .welcome-title {
            font-family: 'davis-sans', sans-serif;
            font-weight: 700;
            font-size: 3.0vw;
            color: #000000;
            margin-bottom: 30px;
            line-height: 1.1;
        }

        .welcome-text {
            font-family: 'davis-sans', sans-serif;
            font-weight: 400;
            font-size: 1.0vw;
            color: #808080;
            line-height: 1.6;
            margin-bottom: 24px;
        }

        /* Step Content Styles */
        .step-header {
            margin-bottom: 40px;
            margin-top: 60px;
        }

        .step-title-main {
            font-family: 'davis-sans', sans-serif;
            font-weight: 700;
            font-size: 3.0vw;
            color: #000000;
            margin-bottom: 15px;
            line-height: 1.1;
        }

        .step-subtitle {
            font-family: 'davis-sans', sans-serif;
            font-weight: 400;
            font-size: 1.0vw;
            color: #808080;
            line-height: 1.4;
            margin: 0;
        }

        /* =====================================================
           ANIMATED FIELD SYSTEM
           ===================================================== */

        /* Form container and basic field layout */
        .form-container {
            max-width: 600px;
            width: 100%;
        }

        .form-field {
            margin-bottom: 1.5vw;
            position: relative;
        }

        /* Field display container - holds both display text and edit button */
        .field-display-container {
            position: relative;
            display: flex;
            align-items: flex-start;
            gap: 0.8vw;
        }

        /* Base field display styles */
        .field-display {
            font-family: 'davis-sans', sans-serif;
            line-height: 1.2;
            cursor: pointer;
            transition: all 0.2s ease;
            flex: 1;
        }

        .field-display:hover {
            opacity: 0.8;
        }

        .field-display.placeholder {
            color: #999999;
            font-style: italic;
        }

        /* Company Name - Large Bold Display */
        .field-display.company-name {
            font-weight: 700;
            font-size: 1.8vw;
            color: #000000;
        }

        /* Website - Smaller, lighter */
        .field-display.website {
            font-weight: 400;
            font-size: 1.0vw;
            color: #666666;
        }

        /* Category - Normal text */
        .field-display.category {
            font-weight: 400;
            font-size: 1.2vw;
            color: #333333;
        }

        /* Description - Paragraph text */
        .field-display.description {
            font-weight: 400;
            font-size: 1.0vw;
            color: #666666;
            line-height: 1.5;
        }

        /* Edit button */
        .edit-btn {
            background: none;
            border: none;
            color: #999999;
            cursor: pointer;
            padding: 0.2vw;
            align-items: center;
            justify-content: center;
            border-radius: 0.2vw;
            transition: all 0.2s ease;
            width: 1.2vw;
            height: 1.2vw;
            display: flex;
            flex-shrink: 0;
            margin-top: 0.1vw; /* Slight vertical alignment adjustment */
        }

        .edit-btn svg {
            width: 1vw;
            height: 1vw;
        }

        .edit-btn:hover {
            color: #666666;
        }

        /* =====================================================
           ANIMATED FIELD EDITOR
           ===================================================== */

        .animated-field-editor {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            pointer-events: none;
            z-index: 10;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s ease, visibility 0.2s ease;
        }

        .animated-field-editor.active {
            pointer-events: all;
            opacity: 1;
            visibility: visible;
        }

        /* The animated border container - positioned to wrap around existing text */
        .field-border {
            position: relative;
            border: 2px solid transparent;
            border-radius: 0.5vw;
            padding: 0.8vw 1vw;
            background: #ffffff;
            /* Position to wrap around the display text */
            margin-top: -0.8vw;
            margin-left: -1vw;
            margin-right: -1vw;
            margin-bottom: -0.8vw;
        }

        /* Clean animated border that draws around the text */
        .field-border::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border: 2px solid #0071bc;
            border-radius: 0.5vw;
            opacity: 0;
            transform: scale(0.9);
            animation: borderAppear 0.5s ease-out forwards;
        }

        /* Border appears and scales to surround text */
        @keyframes borderAppear {
            0% {
                opacity: 0;
                transform: scale(0.9);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        } 100%;
            }
        }

        /* Field label that sits ON the border line, not inside */
        .field-label {
            position: absolute;
            top: 0;
            left: 0.8vw;
            background: #ffffff;
            color: #0071bc;
            font-family: 'davis-sans', sans-serif;
            font-weight: 600;
            font-size: 0.9vw;
            padding: 0 0.4vw;
            opacity: 0;
            z-index: 12;
            transform: translateY(-50%);
            animation: labelFadeIn 0.5s ease-out 0.2s forwards;
        }

        @keyframes labelFadeIn {
            from {
                opacity: 0;
                transform: translateY(-50%) translateY(0.2vw);
            }
            to {
                opacity: 1;
                transform: translateY(-50%);
            }
        }

        /* The actual input field - positioned so text aligns with display text */
        .field-input {
            width: 100%;
            border: none;
            outline: none;
            background: transparent;
            font-family: 'davis-sans', sans-serif;
            color: #000000;
            padding: 0;
            margin: 0;
            position: relative;
            z-index: 11;
        }

        /* Input type-specific styles - match display text positioning exactly */
        .field-input.company-name {
            font-weight: 700;
            font-size: 1.8vw;
            line-height: 1.2;
        }

        .field-input.website {
            font-weight: 400;
            font-size: 1.0vw;
            line-height: 1.2;
        }

        .field-input.category {
            font-weight: 400;
            font-size: 1.2vw;
            line-height: 1.2;
        }

        .field-input.description {
            font-weight: 400;
            font-size: 1.0vw;
            line-height: 1.5;
            min-height: 6vw;
            resize: vertical;
        }

        /* Special styling for select fields */
        .field-input.category {
            font-weight: 400;
            font-size: 1.2vw;
            line-height: 1.2;
            cursor: pointer;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%230071bc' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 0.8vw center;
            background-repeat: no-repeat;
            background-size: 1vw;
            padding-right: 2.5vw;
            appearance: none;
            border: 2px solid #0071bc;
            border-radius: 0.5vw;
        }

        .field-input.category:focus {
            border-color: #005a94;
            box-shadow: 0 0 0 0.2vw rgba(0, 113, 188, 0.15);
        }

        /* Category field gets a different border style */
        .animated-field-editor[id="categoryEditor"] .field-border {
            border: none;
            padding: 0;
            background: transparent;
        }

        .animated-field-editor[id="categoryEditor"] .field-border::before {
            display: none;
        }

        .animated-field-editor[id="categoryEditor"] .field-label {
            position: absolute;
            top: -0.6vw;
            left: 0.8vw;
            background: #ffffff;
            color: #0071bc;
            font-family: 'davis-sans', sans-serif;
            font-weight: 600;
            font-size: 0.9vw;
            padding: 0 0.4vw;
            opacity: 0;
            animation: labelFadeIn 0.5s ease-out 0.2s forwards;
            z-index: 11;
        }

        .field-input.description {
            font-weight: 400;
            font-size: 1.0vw;
            line-height: 1.5;
            min-height: 6vw;
            resize: vertical;
        }

        /* Textarea specific adjustments */
        .field-input[type="textarea"] {
            min-height: 6vw;
            resize: vertical;
            font-family: 'davis-sans', sans-serif;
        }

        /* Character counter for textarea */
        .character-counter {
            position: absolute;
            bottom: 0.5vw;
            right: 0.8vw;
            font-family: 'davis-sans', sans-serif;
            font-size: 0.7vw;
            color: #999999;
            font-weight: 400;
            transition: all 0.2s ease;
            background: #ffffff;
            padding: 0 0.2vw;
        }

        .character-counter.warning {
            font-weight: 700;
            color: #0071bc;
        }

        /* Hide display when editing */
        .form-field.editing .field-display-container {
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s ease;
        }

        /* Show display by default */
        .form-field .field-display-container {
            opacity: 1;
            pointer-events: all;
            transition: opacity 0.2s ease;
        }

        /* Button Styles */
        .get-started-btn, .next-btn {
            background: #0071bc;
            color: #ffffff;
            border: none;
            width: max(12.5vw);
            min-width: 160px;
            height: auto;
            padding: max(1vw, 12px) max(1.5vw, 16px);
            border-radius: max(0.5vw, 6px);
            font-size: max(1.0vw, 14px);
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: max(0.5vw, 6px);
            position: absolute;
            right: max(5vw, 50px);
            bottom: max(3.5vw, 35px);
            z-index: 5;
            box-shadow: 6px 0 16px rgba(0, 0, 0, 0.3);
            transition: all 0.2s ease;
        }

        .get-started-btn:hover, .next-btn:hover {
            background: #005a94;
        }

        .previous-btn {
            background: #ffffff;
            color: #666666;
            border: 2px solid #cccccc;
            width: max(12.5vw);
            min-width: 160px;
            height: auto;
            padding: max(1vw, 12px) max(1.5vw, 16px);
            border-radius: max(0.5vw, 6px);
            font-size: max(1.0vw, 14px);
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: max(0.5vw, 6px);
            position: absolute;
            left: 0;
            bottom: max(3.5vw, 35px);
            z-index: 5;
            transition: all 0.2s ease;
        }

        .previous-btn:hover {
            background: #f8f8f8;
            border-color: #999999;
            color: #333333;
        }

        /* Loading State */
        .loading {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            z-index: 10;
        }

        .loading-title {
            font-family: 'davis-sans', sans-serif;
            font-weight: 700;
            font-size: 48px;
            color: #000000;
            margin-bottom: 20px;
        }

        /* Content fade-in animation */
        .wizard-content {
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
            display: flex;
            width: 100%;
            height: 100%;
        }

        .wizard-content.loaded {
            opacity: 1;
        }

        /* Error State */
        .error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
            padding: 20px;
            border-radius: 8px;
            margin: 20px;
            display: none;
            font-size: 16px;
        }

        /* Success State */
        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 30px;
            border-radius: 8px;
            text-align: center;
            margin: 20px;
            display: none;
        }

        .success h3 {
            font-size: 24px;
            margin-bottom: 15px;
        }

        /* Mobile Progress Bar */
        .mobile-progress {
            display: none;
            height: 4px;
            background: #e6e6e6;
            position: relative;
            margin-bottom: 20px;
        }

        .mobile-progress-fill {
            height: 100%;
            background: #0071bc;
            transition: width 0.3s ease;
        }

        /* Responsive breakpoints */
        @media (max-width: 1000px) {
            .welcome-section {
                width: 60%;
            }
        }

        /* MOBILE/TABLET: Complete Layout Change */
        @media (orientation: portrait), (max-width: 768px) {
            body {
                padding: 0;
            }
            
            body::before {
                display: none;
            }
            
            .wizard-container {
                position: static;
                transform: none;
                width: 100%;
                height: auto;
                min-height: 100vh;
                max-width: none;
                margin: 0;
                border-radius: 0;
                border: none;
                flex-direction: column;
                box-shadow: none;
                background: #ffffff;
                display: flex;
            }

            .wizard-content {
                display: flex;
                flex-direction: column;
                width: 100%;
                min-height: 100vh;
            }

            .sidebar {
                width: 100%;
                padding: 20px;
                box-shadow: none;
                border-bottom: 1px solid #cccccc;
                flex-shrink: 0;
                height: auto;
                order: 1;
            }

            .main-content {
                padding: 20px;
                flex: 1;
                order: 2;
                display: flex;
                flex-direction: column;
            }

            .logo-and-title {
                height: auto;
                margin-bottom: 10px;
            }

            .logo {
                width: 40px;
                height: 40px;
            }

            .logo-text {
                height: auto;
            }

            .conference-title {
                font-size: 16px;
                margin-bottom: 5px;
            }

            .booth-section {
                margin-left: 55px;
                margin-top: 10px;
            }

            .booth-number {
                font-size: 20px;
            }

            .step-navigation {
                display: none;
            }

            .mobile-progress {
                display: block;
            }

            .welcome-section {
                width: 100%;
                max-width: none;
                margin-top: 0;
            }

            .welcome-title {
                font-size: 36px;
            }

            .welcome-text {
                font-size: 16px;
            }

            .get-started-btn, .next-btn, .previous-btn {
                position: static;
                transform: none;
                width: 100%;
                max-width: 300px;
                margin-top: 30px;
                font-size: 18px;
                right: auto;
                bottom: auto;
                left: auto;
                z-index: auto;
            }
        }

        @media (max-width: 480px) {
            .welcome-title {
                font-size: 36px;
            }

            .welcome-text {
                font-size: 14px;
            }

            .booth-number {
                font-size: 18px;
            }
        }
    </style>
</head>
<body>
    <div class="wizard-container">
        <!-- Loading State -->
        <div id="loadingState" class="loading">
            <div class="loading-title">Loading...</div>
        </div>

        <!-- Error State -->
        <div id="errorState" class="error">
            <strong>Oops!</strong> <span id="errorMessage"></span>
        </div>

        <!-- Success State -->
        <div id="successState" class="success">
            <h3>✅ Profile Updated Successfully!</h3>
            <p>Thank you for completing your booth profile. Your information is now under review and will appear on the conference map once approved.</p>
        </div>

        <!-- All Content - Hidden until loaded -->
        <div class="wizard-content" id="wizardContent">
            <!-- Sidebar -->
            <div class="sidebar">
                <div class="logo-section">
                    <div class="logo-and-title">
                        <img src="https://images.squarespace-cdn.com/content/v1/5cf7db4cc0827b0001c9ff81/3c43cc7d-5f2a-4b5e-888e-887d3bb38ebc/Logo+Only.png?format=750w" alt="Campus Stores Conference" class="logo">
                        <div class="logo-text">
                            <div class="conference-title">CAMPUS STORES<br>CONFERENCE</div>
                        </div>
                    </div>
                    <div class="booth-section">
                        <div class="booth-number" id="boothNumber">Booth 501</div>
                    </div>
                </div>

                <div class="step-navigation">
                    <div class="step-item" data-step="0">
                        <div class="step-number">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28.01 28.01">
                                <path d="M14.01,28.01C6.28,28.01,0,21.73,0,14.01S6.28,0,14.01,0s14.01,6.28,14.01,14.01-6.28,14.01-14.01,14.01ZM14.01,2C7.39,2,2,7.39,2,14.01s5.39,12.01,12.01,12.01,12.01-5.39,12.01-12.01S20.63,2,14.01,2Z"/>
                                <path d="M13.25,22.55v-13.78l-1.63.89-1.06-1.8,4.51-2.4h.38v17.09h-2.21Z"/>
                            </svg>
                        </div>
                        <div class="step-title">Company information</div>
                    </div>
                    <div class="step-item" data-step="1">
                        <div class="step-number">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28.04 28.01">
                                <path d="M13.98,28.01C6.25,28.01-.03,21.73-.03,14.01S6.25,0,13.98,0s14.01,6.28,14.01,14.01-6.28,14.01-14.01,14.01ZM13.98,2C7.36,2,1.97,7.39,1.97,14.01s5.39,12.01,12.01,12.01,12.01-5.39,12.01-12.01S20.6,2,13.98,2Z"/>
                                <path d="M8.94,22.55v-.82l5.21-7.15c1.44-1.97,2.18-3.34,2.18-4.73,0-1.66-1.06-2.47-2.42-2.47-1.46,0-2.47.94-2.47,2.35,0,1.27.84,1.78.84,1.78l-1.7,1.25s-1.44-1.15-1.44-3c0-1.49.96-4.3,4.99-4.3s4.58,2.98,4.58,4.51c0,.79-.12,2.16-2.06,4.8l-4.32,5.9h6.7v1.87h-10.08Z"/>
                            </svg>
                        </div>
                        <div class="step-title">Conference highlight</div>
                    </div>
                    <div class="step-item" data-step="2">
                        <div class="step-number">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28.01 28.25">
                                <path d="M14.01,28.25C6.28,28.25,0,21.97,0,14.25S6.28.24,14.01.24s14.01,6.28,14.01,14.01-6.28,14.01-14.01,14.01ZM14.01,2.24C7.39,2.24,2,7.63,2,14.25s5.39,12.01,12.01,12.01,12.01-5.39,12.01-12.01S20.63,2.24,14.01,2.24Z"/>
                                <path d="M10.36,18.67c.46,1.03,1.46,2.33,3.41,2.33,2.09,0,3.1-1.51,3.1-3.43,0-1.8-.86-3.22-3.41-3.22h-1.32v-1.87h1.37c2.02,0,2.78-.89,2.78-2.47s-.79-2.52-2.35-2.52c-1.39,0-2.23.72-2.86,2.11l-1.73-1.10c.79-1.58,2.14-2.93,4.66-2.93,2.93,0,4.66,1.82,4.66,4.25s-1.63,3.24-2.4,3.48c.65.19,2.98.94,2.98,4.22s-2.45,5.42-5.47,5.42c-2.69,0-4.32-1.63-4.99-3.12l1.58-1.15Z"/>
                            </svg>
                        </div>
                        <div class="step-title">Conference team</div>
                    </div>
                    <div class="step-item" data-step="3">
                        <div class="step-number">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28.01 28.01">
                                <path d="M14.01,28.01C6.28,28.01,0,21.73,0,14.01S6.28,0,14.01,0s14.01,6.28,14.01,14.01-6.28,14.01-14.01,14.01ZM14.01,2C7.39,2,2,7.39,2,14.01s5.39,12.01,12.01,12.01,12.01-5.39,12.01-12.01S20.63,2,14.01,2Z"/>
                                <path d="M15.23,22.31v-5.38h-6.84v-1.15l4.22-10.27h2.35l-3.84,9.55h4.1v-5.62h2.26v5.62h2.23v1.87h-2.23v5.38h-2.26Z"/>
                            </svg>
                        </div>
                        <div class="step-title">Product catalogue</div>
                    </div>
                </div>
            </div>

            <!-- Main Content -->
            <div class="main-content">
                <!-- Mobile Progress Bar -->
                <div class="mobile-progress">
                    <div class="mobile-progress-fill" style="width: 0%"></div>
                </div>

                <!-- Welcome Screen -->
                <div id="welcomeSection" class="content-section active">
                    <div class="welcome-section">
                        <h1 class="welcome-title">Welcome</h1>
                        <p class="welcome-text">
                            Thank you for being a valued partner of Campus Stores Canada! To help our conference attendees discover your amazing products and services, we'd love your help completing your booth profile.
                        </p>
                        <p class="welcome-text">
                            You'll be asked to provide <strong>company information</strong>, highlight a <strong>featured product or service</strong>, select your <strong>conference team members</strong>, and optionally upload a <strong>product catalogue</strong>.
                        </p>
                        <p class="welcome-text">
                            Your information will be reviewed by our team before appearing on the conference map. While we're here to help make everything look great, you know your business best, so please share what you think will be most helpful for our members.
                        </p>
                        <p class="welcome-text">
                            We truly appreciate you taking the time to do this - our members are going to love having this information available, and we're excited to showcase your participation at the conference!
                        </p>
                        <button class="get-started-btn" onclick="startWizard()">
                            Get started
                            <span>→</span>
                        </button>
                    </div>
                </div>

                <!-- Step 1: Company Information -->
                <div id="step1Section" class="content-section">
                    <div class="step-header">
                        <h2 class="step-title-main">Company information</h2>
                        <p class="step-subtitle">Please ensure the following information about your company is accurate:</p>
                    </div>

                    <div class="form-container">
                        <!-- Company Name Field -->
                        <div class="form-field" data-field="companyName">
                            <div class="field-display-container">
                                <div class="field-display company-name" id="companyNameDisplay">Loading...</div>
                                <button class="edit-btn" onclick="editField('companyName')">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="m18 2 4 4-14 14H4v-4L18 2z"/>
                                        <path d="m14.5 5.5 4 4"/>
                                    </svg>
                                </button>
                            </div>
                            <!-- Animated field editor -->
                            <div class="animated-field-editor" id="companyNameEditor">
                                <div class="field-border">
                                    <div class="field-label">Company name</div>
                                    <input type="text" class="field-input company-name" id="companyNameInput" />
                                </div>
                            </div>
                        </div>

                        <!-- Website Field -->
                        <div class="form-field" data-field="website">
                            <div class="field-display-container">
                                <div class="field-display website" id="websiteDisplay">website (example.com)</div>
                                <button class="edit-btn" onclick="editField('website')">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="m18 2 4 4-14 14H4v-4L18 2z"/>
                                        <path d="m14.5 5.5 4 4"/>
                                    </svg>
                                </button>
                            </div>
                            <!-- Animated field editor -->
                            <div class="animated-field-editor" id="websiteEditor">
                                <div class="field-border">
                                    <div class="field-label">Website</div>
                                    <input type="url" class="field-input website" id="websiteInput" placeholder="https://example.com" />
                                </div>
                            </div>
                        </div>

                        <!-- Category Field -->
                        <div class="form-field" data-field="category">
                            <div class="field-display-container">
                                <div class="field-display category" id="categoryDisplay">Selected category</div>
                                <button class="edit-btn" onclick="editField('category')">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="m18 2 4 4-14 14H4v-4L18 2z"/>
                                        <path d="m14.5 5.5 4 4"/>
                                    </svg>
                                </button>
                            </div>
                            <!-- Animated field editor -->
                            <div class="animated-field-editor" id="categoryEditor">
                                <div class="field-border">
                                    <div class="field-label">Primary category</div>
                                    <select class="field-input category" id="categoryInput">
                                        <option value="">Select your primary category</option>
                                        <option value="Accessories">Accessories</option>
                                        <option value="Apparel">Apparel</option>
                                        <option value="Books">Books</option>
                                        <option value="Campus Living">Campus Living</option>
                                        <option value="Food & Beverages">Food & Beverages</option>
                                        <option value="Gifts & Promotional Products">Gifts & Promotional Products</option>
                                        <option value="Graduation & Regalia">Graduation & Regalia</option>
                                        <option value="Health & Beauty">Health & Beauty</option>
                                        <option value="School Office & Lab Supplies">School Office & Lab Supplies</option>
                                        <option value="Store Operations">Store Operations</option>
                                        <option value="Technology & Electronics">Technology & Electronics</option>
                                        <option value="Other">Other</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Company Description Field -->
                        <div class="form-field" data-field="description">
                            <div class="field-display-container">
                                <div class="field-display description" id="descriptionDisplay">Give our members an elevator pitch of who you are.</div>
                                <button class="edit-btn" onclick="editField('description')">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="m18 2 4 4-14 14H4v-4L18 2z"/>
                                        <path d="m14.5 5.5 4 4"/>
                                    </svg>
                                </button>
                            </div>
                            <!-- Animated field editor -->
                            <div class="animated-field-editor" id="descriptionEditor">
                                <div class="field-border">
                                    <div class="field-label">Company description</div>
                                    <textarea class="field-input description" id="descriptionInput" maxlength="300" placeholder="Give our members an elevator pitch of who you are."></textarea>
                                    <div class="character-counter" id="charCounter">300</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Navigation Buttons -->
                    <button class="previous-btn" onclick="previousStep()" id="prevBtn">
                        <span>←</span>
                        Previous step
                    </button>
                    <button class="next-btn" onclick="nextStep()" id="nextBtn">
                        Next step
                        <span>→</span>
                    </button>
                </div>

                <!-- Step 2: Conference Highlight -->
                <div id="step2Section" class="content-section">
                    <h2>Conference Highlight</h2>
                    <!-- Content will be added here -->
                </div>

                <!-- Step 3: Conference Team -->
                <div id="step3Section" class="content-section">
                    <h2>Conference Team</h2>
                    <!-- Content will be added here -->
                </div>

                <!-- Step 4: Product Catalogue -->
                <div id="step4Section" class="content-section">
                    <h2>Product Catalogue</h2>
                    <!-- Content will be added here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // ===========================================
        // WIZARD STATE MANAGEMENT
        // ===========================================
        let currentStep = 0;
        const totalSteps = 4;
        let vendorData = {};
        let organizationContacts = [];
        let conferenceTeam = [];

        const API_BASE = '/api';

        // ===========================================
        // ANIMATED FIELD EDITING SYSTEM
        // ===========================================
        let activeField = null;
        let formState = {
            companyName: '',
            website: '',
            category: '',
            description: ''
        };

        /**
         * Edit a field with animated border and label
         * @param {string} fieldName - The field to edit (companyName, website, category, description)
         */
        function editField(fieldName) {
            // If another field is being edited, save it first
            if (activeField && activeField !== fieldName) {
                saveField(activeField);
            }

            activeField = fieldName;
            
            // Mark field as editing (hides display, shows editor)
            const fieldElement = document.querySelector(`[data-field="${fieldName}"]`);
            fieldElement.classList.add('editing');
            
            // Show the animated editor
            const editor = document.getElementById(`${fieldName}Editor`);
            const input = document.getElementById(`${fieldName}Input`);
            
            editor.classList.add('active');
            
            // Set the current value and select all text
            if (fieldName === 'category') {
                input.value = formState[fieldName] || '';
            } else {
                input.value = formState[fieldName] || '';
            }
            
            // Focus and select text (slight delay to allow animation)
            setTimeout(() => {
                input.focus();
                if (input.tagName === 'SELECT') {
                    // For select, just focus
                    input.focus();
                } else if (input.tagName === 'TEXTAREA') {
                    // For textarea, select all text
                    input.setSelectionRange(0, input.value.length);
                } else {
                    // For regular inputs, select all text
                    input.select();
                }
                
                // Update character counter for textarea
                if (fieldName === 'description') {
                    updateCharCounter();
                }
            }, 100);
            
            console.log('🎬 Editing field:', fieldName, 'with value:', formState[fieldName]);
        }

        /**
         * Save the field and hide the editor
         * @param {string} fieldName - The field to save
         */
        function saveField(fieldName) {
            const input = document.getElementById(`${fieldName}Input`);
            const newValue = input.value.trim();
            
            // Special validation for category - don't allow empty
            if (fieldName === 'category' && !newValue) {
                // Keep editor open if category is empty
                setTimeout(() => {
                    input.focus();
                }, 100);
                return;
            }
            
            // Update form state
            formState[fieldName] = newValue;
            
            // Update display
            updateFieldDisplay(fieldName, newValue);
            
            // Hide editor and show display
            const fieldElement = document.querySelector(`[data-field="${fieldName}"]`);
            const editor = document.getElementById(`${fieldName}Editor`);
            
            // Remove editing class first to show display, then hide editor after transition
            fieldElement.classList.remove('editing');
            
            setTimeout(() => {
                editor.classList.remove('active');
            }, 200); // Match the transition duration
            
            activeField = null;
            
            console.log('💾 Saved field:', fieldName, '=', newValue);
        }

        /**
         * Update the field display with new value
         * @param {string} fieldName - The field name
         * @param {string} value - The new value
         */
        function updateFieldDisplay(fieldName, value) {
            const display = document.getElementById(`${fieldName}Display`);
            
            if (fieldName === 'website') {
                // Strip https://, http://, and www. from display
                let cleanUrl = value || '';
                if (cleanUrl) {
                    cleanUrl = cleanUrl.replace(/^https?:\/\//, '').replace(/^www\./, '');
                }
                display.textContent = cleanUrl || 'website (example.com)';
                display.className = cleanUrl ? 'field-display website' : 'field-display website placeholder';
            } else if (fieldName === 'category') {
                display.textContent = value || 'Selected category';
                display.className = value ? 'field-display category' : 'field-display category placeholder';
            } else if (fieldName === 'description') {
                display.textContent = value || 'Give our members an elevator pitch of who you are.';
                display.className = value ? 'field-display description' : 'field-display description placeholder';
            } else {
                display.textContent = value || 'Company name';
                display.className = value ? 'field-display company-name' : 'field-display company-name placeholder';
            }
        }

        /**
         * Update character counter for textarea
         */
        function updateCharCounter() {
            const textarea = document.getElementById('descriptionInput');
            const counter = document.getElementById('charCounter');
            if (textarea && counter) {
                const remaining = 300 - textarea.value.length;
                counter.textContent = remaining;
                counter.className = remaining <= 75 ? 'character-counter warning' : 'character-counter';
            }
        }

        // ===========================================
        // EVENT LISTENERS SETUP
        // ===========================================
        function setupFormEventListeners() {
            // Set up event listeners for all field inputs
            const fields = ['companyName', 'website', 'category', 'description'];
            
            fields.forEach(fieldName => {
                const input = document.getElementById(`${fieldName}Input`);
                if (!input) return;
                
                // Auto-save on blur (when user clicks away)
                input.addEventListener('blur', () => {
                    if (activeField === fieldName) {
                        saveField(fieldName);
                    }
                });
                
                // Save on Enter key (except for textarea)
                if (fieldName !== 'description') {
                    input.addEventListener('keydown', (e) => {
                        if (e.key === 'Enter') {
                            e.preventDefault();
                            input.blur(); // This will trigger save
                        }
                        if (e.key === 'Escape') {
                            // Cancel editing - restore original value
                            input.value = formState[fieldName] || '';
                            input.blur();
                        }
                    });
                }
                
                // Special handling for select (category)
                if (fieldName === 'category') {
                    input.addEventListener('change', () => {
                        if (activeField === fieldName) {
                            saveField(fieldName);
                        }
                    });
                }
                
                // Special handling for textarea (description)
                if (fieldName === 'description') {
                    input.addEventListener('input', updateCharCounter);
                    input.addEventListener('keydown', (e) => {
                        if (e.key === 'Escape') {
                            input.value = formState[fieldName] || '';
                            input.blur();
                        }
                    });
                }
            });
            
            // Click outside to save
            document.addEventListener('click', (e) => {
                if (activeField) {
                    const activeEditor = document.getElementById(`${activeField}Editor`);
                    const isClickInsideEditor = activeEditor && activeEditor.contains(e.target);
                    const isEditButton = e.target.closest('.edit-btn');
                    
                    if (!isClickInsideEditor && !isEditButton) {
                        saveField(activeField);
                    }
                }
            });
            
            console.log('🎯 Form event listeners set up');
        }

        // ===========================================
        // INITIALIZATION
        // ===========================================
        document.addEventListener('DOMContentLoaded', async () => {
            const urlParams = new URLSearchParams(window.location.search);
            
            // Check for OAuth callback success/error
            if (urlParams.get('success') === 'true') {
                console.log('🎉 OAuth callback success!');
                showSuccessState();
                return;
            }
            
            if (urlParams.get('error')) {
                const error = urlParams.get('error');
                console.error('❌ OAuth callback error:', error);
                showErrorState(getErrorMessage(error));
                return;
            }
            
            // Normal page load - get token and load vendor data
            const token = urlParams.get('token');
            if (!token) {
                showErrorState('Invalid access link. Please check your email for the correct URL.');
                return;
            }

            try {
                console.log('🪄 Loading vendor data for token:', token);
                await loadVendorData(token);
                setupFormEventListeners();
                showWelcomeScreen();
            } catch (error) {
                console.error('Error loading vendor data:', error);
                showErrorState('Unable to load your profile information. Please try again later.');
            }
        });

        // ===========================================
        // WIZARD NAVIGATION
        // ===========================================
        function startWizard() {
            currentStep = 1;
            showStep(currentStep);
            updateStepNavigation();
        }

        function nextStep() {
            // Save any active field before moving
            if (activeField) {
                saveField(activeField);
            }
            
            if (currentStep < totalSteps) {
                currentStep++;
                showStep(currentStep);
                updateStepNavigation();
                updateMobileProgress();
            }
        }

        function previousStep() {
            // Save any active field before moving
            if (activeField) {
                saveField(activeField);
            }
            
            if (currentStep > 0) {
                currentStep--;
                showStep(currentStep);
                updateStepNavigation();
                updateMobileProgress();
            }
        }

        function showStep(stepNumber) {
            // Hide all content sections
            const sections = document.querySelectorAll('.content-section');
            sections.forEach(section => section.classList.remove('active'));

            // Show welcome or specific step
            if (stepNumber === 0) {
                document.getElementById('welcomeSection').classList.add('active');
            } else {
                document.getElementById(`step${stepNumber}Section`).classList.add('active');
            }
        }

        function updateStepNavigation() {
            // Remove active class from all steps
            document.querySelectorAll('.step-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Add active class to current step
            if (currentStep > 0) {
                const activeStepItem = document.querySelector(`[data-step="${currentStep - 1}"]`);
                if (activeStepItem) {
                    activeStepItem.classList.add('active');
                }
            }
        }

        function updateMobileProgress() {
            const progressFill = document.querySelector('.mobile-progress-fill');
            const progressPercent = ((currentStep - 1) / (totalSteps - 1)) * 100;
            progressFill.style.width = `${Math.max(0, progressPercent)}%`;
        }

        // ===========================================
        // STATE MANAGEMENT
        // ===========================================
        function showWelcomeScreen() {
            showStep(0);
            hideLoadingState();
            hideErrorState();
            hideSuccessState();
            // Fade in content
            document.getElementById('wizardContent').classList.add('loaded');
        }

        function showLoadingState() {
            document.getElementById('loadingState').style.display = 'block';
            document.getElementById('wizardContent').style.display = 'none';
            hideErrorState();
            hideSuccessState();
        }

        function hideLoadingState() {
            document.getElementById('loadingState').style.display = 'none';
            document.getElementById('wizardContent').style.display = 'flex';
        }

        function showErrorState(message) {
            document.getElementById('errorMessage').textContent = message;
            document.getElementById('errorState').style.display = 'block';
            hideLoadingState();
            hideSuccessState();
        }

        function hideErrorState() {
            document.getElementById('errorState').style.display = 'none';
        }

        function showSuccessState() {
            document.getElementById('successState').style.display = 'block';
            hideLoadingState();
            hideErrorState();
        }

        function hideSuccessState() {
            document.getElementById('successState').style.display = 'none';
        }

        function getErrorMessage(error) {
            switch (error) {
                case 'oauth_denied':
                    return 'Google Drive authorization was denied. Your profile was saved without files.';
                case 'oauth_invalid':
                    return 'Invalid authorization response. Please try again.';
                case 'token_failed':
                    return 'Failed to get authorization token. Please try again.';
                case 'callback_failed':
                    return 'Authorization callback failed. Please try again.';
                default:
                    return 'An error occurred during authorization.';
            }
        }

        // ===========================================
        // DATA LOADING
        // ===========================================
        async function loadVendorData(token) {
            showLoadingState();
            
            try {
                console.log('📡 Fetching vendor profile...');
                const response = await fetch(`${API_BASE}/vendor-profile?token=${token}`);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                vendorData = await response.json();
                console.log('✅ Vendor data loaded:', vendorData);
                
                populateForm(vendorData);
                await loadOrganizationContacts(token);
                
            } catch (error) {
                console.error('💥 Failed to load vendor data:', error);
                throw error;
            }
        }

        async function loadOrganizationContacts(token) {
            console.log('👥 Loading organization contacts...');
            
            try {
                const response = await fetch(`${API_BASE}/get-organization-contacts?token=${token}`);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                organizationContacts = data.contacts;
                
                console.log(`✅ Loaded ${organizationContacts.length} contacts for ${data.organizationName}`);
                
            } catch (error) {
                console.error('💥 Error loading contacts:', error);
                // Don't throw - contacts are optional
            }
        }

        function populateForm(data) {
            console.log('📝 Populating form with:', data);
            
            // Update booth info
            document.getElementById('boothNumber').textContent = `Booth ${data.boothNumber}`;
            
            // Populate form state with organization data
            formState.companyName = data.organization?.name || '';
            formState.website = data.organization?.website || '';
            formState.category = data.organization?.primaryCategory || '';
            formState.description = data.organization?.description || '';
            
            // Update displays immediately (not in edit mode)
            updateFieldDisplay('companyName', formState.companyName);
            updateFieldDisplay('website', formState.website);
            updateFieldDisplay('category', formState.category);
            updateFieldDisplay('description', formState.description);
            
            // Also populate the actual input fields so they're ready when edited
            document.getElementById('companyNameInput').value = formState.companyName;
            document.getElementById('websiteInput').value = formState.website;
            document.getElementById('categoryInput').value = formState.category;
            document.getElementById('descriptionInput').value = formState.description;
            
            // Store data for later use in form steps
            window.formData = {
                organization: data.organization,
                boothNumber: data.boothNumber
            };
            
            console.log('✅ Form populated with data from database');
        }

        // ===========================================
        // UTILITY FUNCTIONS
        // ===========================================
        function handleFileSelect(input, displayElementId) {
            const file = input.files[0];
            const displayElement = document.getElementById(displayElementId);
            
            if (file) {
                displayElement.textContent = `Selected: ${file.name} (${(file.size / 1024 / 1024).toFixed(2)} MB)`;
                displayElement.style.color = '#28a745';
            } else {
                displayElement.textContent = '';
            }
        }
    </script>
</body>
</html>
